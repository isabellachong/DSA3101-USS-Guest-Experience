# -*- coding: utf-8 -*-
"""DSA3101 Group Project (Group 3, Subgroup A, Question 4)

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1CTQgJJ3dJQmwRsrum9mjqzmCXqG40fS8

# Subgroup A, Question 4

## Importing From Google Drive
"""

# Importing From Google Drive
from google.colab import drive
drive.mount('/content/drive')

"""## Importing The Necessary Packages"""

# Importing The Necessary Packages

# 1. pandas - to be used for data cleaning
import pandas as pd

# 2. numpy - to be used for numerical computing
import numpy as np

# 3. matplotlib - to be used for data visualizations
import matplotlib.pyplot as plt

# 4. seaborn - to be used for data visualizations
import seaborn as sns

# 5. sklearn - to be used for Machine Learning implementation
import sklearn

"""## Other Settings Implemented Using Pandas

This is an optional step but the following block of code below helps to change the output structure of the code such that

**1) All the columns of the dataset will be printed**

**2) The width of the dataset output is not limited to the display width of Google Colab**

**3) Prevent wrapping the output to multiple lines on Google Colab to improve readibility**
"""

# Show all columns of the dataset when printed
pd.set_option('display.max_columns', None)

# Don't limit the display width of the output
pd.set_option('display.width', None)

# Don't wrap the output to multiple lines
pd.set_option('display.expand_frame_repr', False)

"""## Reading The Excel File From Google Drive To Google Colab"""

# Specify the file path of the excel file
file_path = '/content/drive/MyDrive/uss_survey_responses.xlsx'

# Read the excel file into Google Colab using read_excel
df = pd.read_excel(file_path)

# Display the first few rows of the dataset
print(df.head())

"""## Examining The Number Of Rows And Columns Of The Dataset

We can examine the number of rows and columns of the dataset using `df.shape`, where the first number represents the number of rows and the second number represents the number of columns of the dataset.
"""

# Finding the number of rows and columns of the dataset
num_rows, num_columns = df.shape

# Displaying the results
print("Number of Rows:", num_rows)
print("Number of Columns:", num_columns)

"""We observe that there are 505 rows and 56 columns in the dataset.
The columns include the email address of the survey responders, as well as their responses to the 20 questions in the survey (some of the survey questions have various subparts, hence more than 20 columns altogether). We currently have 505 survey responses in our dataset.

Since the email address is considered highly confidential, in order to maintain data integrity to prevent exposure of information and privacy leaks, we should remove the `email address` column. Also, the `time_entry` column is not really important in our analysis as this column just represents when the respondants have completed the survey (within a period of a few days, all recent entries). We can also remove the column.
"""

# Removing the email addressand time_entry column of the dataset
df = df.drop('Email Address', axis = 1)
df = df.drop('time_entry', axis = 1)

# Displaying the first few rows of the updated dataset
print(df.head())

"""## What Each Column Of The Dataset Represent (From The Survey Questions)

Here is a description of the what each of the various columns of the dataset represent:

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <style>
        table {
            width: 50%;
            border-collapse: collapse;
            margin: 20px 0;
        }
        th, td {
            border: 1px solid black;
            padding: 10px;
            text-align: center;
        }
    </style>
</head>
<body>
    <table>
        <thead>
            <tr>
                <th>Column Name</th>
                <th>Description Of Column</th>
            </tr>
        </thead>
        <tbody>
            <tr>
                <td>q1</td>
                <td>Which type of theme park visitor best describes you?</td>
            </tr>
            <tr>
                <td>q2_1</td>
                <td>What is your age range?</td>
            </tr>
            <tr>
                <td>q2_2</td>
                <td>What is your gender?</td>
            </tr>
            <tr>
                <td>q3</td>
                <td>Are you a tourist or a local?</td>
            </tr>
            <tr>
                <td>q4_1</td>
                <td>For the category on thrill rides, what is the average time you queued for?</td>
            </tr>
            <tr>
                <td>q4_2</td>
                <td>For the category on interactive exhibits, what is the average time you queued for?</td>
            </tr>
            <tr>
                <td>q4_3</td>
                <td>For the category on performances, what is the average time you queued for?</td>
            </tr>
            <tr>
                <td>q4_4</td>
                <td>For the category on food and dining, what is the average time you queued for?</td>
            </tr>
            <tr>
                <td>q5_1</td>
                <td>For the category on thrill rides, what is considered an unacceptable wait time? (Integer in Minutes)</td>
            </tr>
            <tr>
                <td>q5_2</td>
                <td>For the category on interactive exhibits, what is considered an unacceptable wait time? (Integer in Minutes)</td>
            </tr>
            <tr>
                <td>q5_3</td>
                <td>For the category on performances, what is considered an unacceptable wait time? (Integer in Minutes)</td>
            </tr>
            <tr>
                <td>q5_4</td>
                <td>For the category on food and dining, what is considered an unacceptable wait time? (Integer in Minutes)</td>
            </tr>
            <tr>
                <td>q6</td>
                <td>The type of attractions you enjoy the most when visiting USS</td>
            </tr>
            <tr>
                <td>q7</td>
                <td>Factors that will influence your decision to visit a theme park like USS?</td>
            </tr>
            <tr>
                <td>q8</td>
                <td>What type of events influence your decision to visit?</td>
            </tr>
            <tr>
                <td>q9</td>
                <td>How long do you usually spend at USS? (Integer in Hours)</td>
            </tr>
            <tr>
                <td>q10</td>
                <td>When do you usually visit theme parks or attractions like USS?</td>
            </tr>
            <tr>
                <td>q11</td>
                <td>When do you typically purchase meals or snacks at the eateries/restaurants?</td>
            </tr>
            <tr>
                <td>q12</td>
                <td>How do you usually navigate a theme park like USS?</td>
            </tr>
            <tr>
                <td>q13</td>
                <td>Would you be willing to wear a digital watch given by USS to track your location and activity?</td>
            </tr>
            <tr>
                <td>q14_1</td>
                <td>At what time of the day do you usually visit roller coasters?</td>
            </tr>
            <tr>
                <td>q14_2</td>
                <td>At what time of the day do you usually visit water rides?</td>
            </tr>
            <tr>
                <td>q14_3</td>
                <td>At what time of the day do you usually visit 3D/4D experiences?</td>
            </tr>
            <tr>
                <td>q14_4</td>
                <td>At what time of the day do you usually visit performances?</td>
            </tr>
            <tr>
                <td>q14_5</td>
                <td>At what time of the day do you usually visit roadshows?</td>
            </tr>
            <tr>
                <td>q14_6</td>
                <td>At what time of the day do you usually visit eateries and restaurants?</td>
            </tr>
            <tr>
                <td>q14_7</td>
                <td>At what time of the day do you usually visit souvenir shops?</td>
            </tr>
            <tr>
                <td>q14_8</td>
                <td>At what time of the day do you usually visit other rides (carousel rides, teacup rides etc.)?</td>
            </tr>
            <tr>
                <td>q15</td>
                <td>How likely are you to recommend USS to others?</td>
            </tr>
            <tr>
                <td>q16_1</td>
                <td>How satisfied are you with the overall service of the queuing system?</td>
            </tr>
            <tr>
                <td>q16_2</td>
                <td>How satisfied are you with the overall service of retail experience?</td>
            </tr>
            <tr>
                <td>q16_3</td>
                <td>How satisfied are you with the overall service of eateries/restaurants?</td>
            </tr>
            <tr>
                <td>q16_4</td>
                <td>How satisfied are you with the overall service of photo taking exhibitions?</td>
            </tr>
            <tr>
                <td>q16_5</td>
                <td>How satisfied are you with the overall service of entertainment attractions?</td>
            </tr>
            <tr>
                <td>q17_1</td>
                <td>Give an overall rating for ticketing information accessibility</td>
            </tr>
            <tr>
                <td>q17_2</td>
                <td>Give an overall rating for rides and attractions</td>
            </tr>
            <tr>
                <td>q17_3</td>
                <td>Give an overall rating for entertainment and performances</td>
            </tr>
            <tr>
                <td>q17_4</td>
                <td>Give an overall rating for food and beverage</td>
            </tr>
            <tr>
                <td>q17_5</td>
                <td>Give an overall rating for merchandise and shopping</td>
            </tr>
            <tr>
                <td>q17_6</td>
                <td>Provide an overall rating for crowd management, comfort and staff helpfulness</td>
            </tr>
            <tr>
                <td>q18_1</td>
                <td>For ticketing information accessibility, which of the following services are you not satisfied with?</td>
            </tr>
            <tr>
                <td>q18_2</td>
                <td>For rides and attractions, which of the following services are you not satisfied with?</td>
            </tr>
            <tr>
                <td>q18_3</td>
                <td>For entertainment and performances, which of the following services are you not satisfied with?</td>
            </tr>
            <tr>
                <td>q18_4</td>
                <td>For food and beverage, which of the following services are you not satisfied with?</td>
            </tr>
            <tr>
                <td>q18_5</td>
                <td>For merchandise and shopping, which of the following services are you not satisfied with?</td>
            </tr>
            <tr>
                <td>q18_6</td>
                <td>For crowd management, comfort and staff helpfulness, which of the following services are you not satisfied with?</td>
            </tr>
            <tr>
                <td>q19_1</td>
                <td>How important is ticketing information accessibility to your overall satisfaction?</td>
            </tr>
            <tr>
                <td>q19_2</td>
                <td>How important is crowd management to your overall satisfaction?</td>
            </tr>
            <tr>
                <td>q19_3</td>
                <td>How important is staff helpfulness to your overall satisfaction?</td>
            </tr>
            <tr>
                <td>q19_4</td>
                <td>How important is safety and cleanliness to your overall satisfaction?</td>
            </tr>
            <tr>
                <td>q19_5</td>
                <td>How important is rides and attractions to your overall satisfaction?</td>
            </tr>
            <tr>
                <td>q19_6</td>
                <td>How important is food and beverage to your overall satisfaction?</td>
            </tr>
            <tr>
                <td>q19_7</td>
                <td>How important is merchandise and shopping to your overall satisfaction?</td>
            </tr>
            <tr>
                <td>q19_8</td>
                <td>How important is entertainment and performances to your overall satisfaction?</td>
            </tr>
            <tr>
                <td>q20</td>
                <td>Is there any other feedback about your USS experience that you want to mention?</td>
            </tr>
        </tbody>
    </table>
</body>
</html>

****************************************************************************************************************************************************************

### Business Question 4: Impact Of Marketing Strategies On Guest Behaviour

#### Overview Of Using Marketing Strategies:

To assess the impact of marketing strategies on guest behavior, it is essential to first identify the characteristics of customers who spend at Universal Studios Singapore (USS). Tailoring marketing efforts to underrepresented groups without considering the broader customer base may limit their effectiveness in enhancing the overall guest experience. This, in turn, could result in minimal or no significant increase in demand for USS, potentially restricting revenue growth and preventing the park from maximizing its financial performance.

However, merely identifying customer characteristics is not sufficient to develop effective marketing strategies. It is equally important to analyze shifts in customer trends over time—for example, observing a consistent increase in the percentage of visitors aged 13 to 21. By tracking these evolving patterns, USS can better predict future customer demographics and tailor its marketing efforts accordingly.

Focusing on growing customer segments allows USS to implement targeted strategies that align with emerging trends, maximizing demand and ensuring sustained business growth. By comparing past demographic data with current visitor profiles, we can assess percentage changes across different customer segments. This analysis enables USS to better understand evolving visitor trends and develop targeted strategies to align with shifting consumer behaviors.

We need to analyze past campaign data to study changes in guest segment size and satisfaction. To identify trends and analyze shifts in customer patterns, it is essential to utilize historical demographic data from visitors to Universal Studios Singapore (USS), ideally from 10 or more years ago. This long-term dataset provides a more accurate basis for trend analysis, minimizing short-term fluctuations and errors.

To tackle this business question, we need to

Step 1: From the current survey dataset, we will obtain and analyze the demographics of visitors, including age range, visitor type, gender, salary range as well as time of visitations and special occasions

Step 2: Similar to Step 1, we will obtain and analyze the the demographics of visitors who visited USS some time ago

Step 3: We will then compare the demographics of current visitors versus visitors several years ago using some visualizations + identify some noticeable increasing trends, as well as the majority classes

Step 4: We will implement effective strategies to tailor to these large groups of people to increase user experience and ultimately increase revenue/profits for USS

++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

#### Step 1: Obtain And Analyze The Demographics Of Current Visitors In USS

From the current survey dataset that we have obtained, we can categorize the guest types based on several factors listed below:

*   **Visitor Demographics - Age, Gender, Nationality (Tourist/Local)**
*   **Visitor Type - Solo Travellor/Visiting With Friends/Family/Children etc.**
*   **Time Of Day - Weekdays/Weekends/Public Holidays etc.**
*   **Special Events - Halloween/Christmas etc.**

We will explore each bullet point one by one. We will first start with the Visitor Demographics.

--------------------------------------------------------------------------------

##### Visitor Demographics

For the point on Visitor Demographics, there are several features that we can explore. These include:

*   **Age Of Visitors**
*   **Gender Of Visitors**
*   **Nationality Of Visitors (Tourists/Local)**

###### Age Of Visitors

First, for the age of visitors, we split the visitors ages into various categories, such as

1.   Below 12 years old (Children)
1.   13 to 20 years old (Teenagers)
3.   21 to 34 years old (Young Adults)
4.   35 to 49 years old (Mid-Career Adults)
5.   50 to 64 years old (Mature Adults)
6.   65 years old and above (Seniors)

We can plot the number of each type of visitors using a bar chart, categrorized by age group. The column that we will be focusing on is `q2_1` (What is your age range?)
"""

# Extract q2 (Age Range Column)
df_agerange = df['q2_1']

# Define the desired order of age categories
order = ["Below 12 Years Old", "13 To 20 Years Old", "21 To 34 Years Old",
         "35 To 49 Years Old", "50 To 64 Years Old", "65 Years Old And Above"]

# Count occurrences and reindex to match the desired order
person_type_counts = df_agerange.value_counts().reindex(order, fill_value=0)

# Convert index to categorical with specified order
person_type_counts.index = pd.Categorical(person_type_counts.index, categories=order, ordered=True)

# Create a bar plot
plt.figure(figsize=(10, 6))
ax = sns.barplot(x=person_type_counts.index, y=person_type_counts.values, order=order, color="skyblue")

# Add title and labels
plt.title('Number Of Respondents Based On Age Range (Current Data)')
plt.xlabel('Age Range Categories')
plt.ylabel('Number of Respondents')

# Rotate x-axis labels for better readability
plt.xticks(rotation=30, ha='right')

# Add grid lines for better readability
plt.grid(axis='y', linestyle='--', alpha=0.3)

# Add number labels on top of bars
for i, value in enumerate(person_type_counts.values):
    ax.text(i, value + 1, str(value), ha='center', va='bottom', fontsize=10)

# Show the plot
plt.show()

"""Key Observations And Insights:

1) The age range category that has the highest number of respondants is 21 To 34 Years Old (Young Adults). This is followed by 13 To 20 Years Old (Teenagers) and Below 12 Years Old (Children).

2) The number of respondants aged 34 years and below contributes to the majority of the total number of survey responses, almost 75% of the total number of respondants are in this age range.

3) From 35 years old onwards, the bar graph shows a continuous decline in the number of respondants. The lowest number of respondants turned out to be 65 years old and above (Elderly).

We will analyse the age range categories further using heatmaps further in Step 3 when we are interested in comparing the proportions of respondants with particular age ranges over time.

--------------------------------------------------------------------------------

###### Gender Of Visitors

We can plot the proportion of gender of visitors using a pie chart. The column that we will be focusing on is `q2_2` (What is your gender?)

***NOTE: For simplicity, we only assume two possible genders - Male and Female. We have made this question a mandatory question for the survey respondants to answer and give them only two options to choose from. We have explained to the respondants on the main page that their information will be kept confidential and will not be exposed to the public or on any websites. The information will only be used for data analysis and insights.***
"""

# Extract gender column
df_gender = df['q2_2']

# Count the number of Male and Female in dataset
gender_counts = df_gender.value_counts()

# Define colors: Blue for Male, Pink for Female
colors = ['#ff69b4', '#377eb8']

# Create a pie chart
plt.figure(figsize = (9, 9))
plt.pie(gender_counts, labels = gender_counts.index, autopct = '%1.1f%%',
        colors = colors, startangle = 90, wedgeprops = {'edgecolor': 'black'})

# Add title
plt.title('Proportion of Male and Female Participants (Current Data)')

# Add legend
plt.legend(title = "Gender", loc = "best")

# Show the plot
plt.show()

"""The pie chart reveals that 61% of respondents are female, while the remaining 39% are male. This indicates that the majority of visitors to Universal Studios Singapore (USS) are female. However, to determine whether this trend is a recent development or a long-standing pattern, it is essential to compare these proportions with historical data. Analyzing past visitor demographics will help assess any shifts in gender distribution over time.

--------------------------------------------------------------------------------

###### Nationality Of Visitors

We can similarly plot the proportion of Nationality of visitors using a pie chart. The column that we will be focusing on is `q3` (Are you a tourist or a local?)

***NOTE: For simplicity, we only assume two possible answers - tourist or local. This is because if we ask the tourists further on which country that they are from, there will be a myriad of different answers as there are over 200 countries in the world. This might result in too many categories for us to analyze and given the limited number of survey responses that we have collected, some countries might only have 1 or 2 responses which cannot be used to compare differences subsequently in Step 3***
"""

# Extract nationality column
df_nationality = df['q3']

# Count the number of Locals and Tourists in dataset
nationality_counts = df_nationality.value_counts()

# Define colors: Salmon Red for Local, Pastel Blue for Tourist
colors = ['#FA8072', '#AEC6CF']

# Create a pie chart
plt.figure(figsize = (9, 9))
plt.pie(nationality_counts, labels = nationality_counts.index, autopct = '%1.1f%%',
        colors = colors, startangle = 90, wedgeprops = {'edgecolor': 'black'})

# Add title
plt.title('Proportion of Locals And Tourists (Current Data)')

# Add legend
plt.legend(title = "Nationality Type", loc = "best")

# Show the plot
plt.show()

"""The pie chart reveals that 55.2% of respondents are locals, while the remaining 44.8% are tourists. This indicates that the majority of visitors to Universal Studios Singapore (USS) are locals. This might at first seem a little concerning as despite the small population size of Singapore (only around 6 million compared to billions in the world), it still accounts for the majority of visitor count to USS. We need to explore further as to why there might be insufficient tourists in USS.

However, to determine whether this trend is a recent development or a long-standing pattern, it is essential to compare these proportions with historical data. Analyzing past visitor demographics will help assess any shifts in nationality distribution over time.

--------------------------------------------------------------------------------

##### Visitor Type

The types of visitors can be categorized as follows:

*   Solo Traveller
*   Visiting with Friends
*   Families with Young Children
*   Families with Teenagers
*   Families with Elderly

To visualize the distribution of the above visitor types, we will plot a bar chart using column `q1` of the `uss_survey_responses.xlxs` dataset. (Which type of theme park visitor best describes you?)
"""

# Specify order
order = ['Solo Traveller', 'Visiting With Friends', 'Family With Young Children',
         'Family With Teenagers', 'Family With Elderly']

# Create a bar plot
plt.figure(figsize=(10, 6))
ax = sns.countplot(x='q1', data=df, order=order, color="lightblue")

# Add title and labels
plt.title('Number Of Respondents Based On Visitor Type')
plt.xlabel('Visitor Categories')
plt.ylabel('Number of Respondents')

# Rotate x-axis labels for better readability
plt.xticks(rotation=30, ha='right')

# Add grid lines for better readability
plt.grid(axis='y', linestyle='--', alpha=0.3)

# Add number labels on top of bars
for p in ax.patches:
    ax.annotate(f'{int(p.get_height())}',
                (p.get_x() + p.get_width() / 2., p.get_height()),
                ha='center', va='bottom', fontsize=10)

# Show the plot
plt.show()

"""Based on our survey responses, we can see that the largest group of visitors are families with young children. Guests who visit with friends form the next largest group, followed by familiy with teenagers. Solo travellers also form a sizeable group, making up 19% of the total survey respondants. Analyzing past visitor types will help us explore how the distribution of visitor types have shifted over time.

--------------------------------------------------------------------------------

##### Time Of Day

For the feature on the Time Of Day, we can break down into two categories:

**1st Category: When do visitors usually spend their day at USS?**

**2nd Category: What time of the day constitutes the highest demand?**

###### Category 1:

For the first category of "When do visitors usually spend their day at USS?", we can make use of column `q10` (When do you usually visit theme parks or attractions like USS?). This question targets the day type aspect of visitation. We can make use of a bar graph to plot the number of responses who select the possible options below.

The Possible Options Include:

*   Weekdays
*   Weekends
*   Public Holidays
*   School Holidays
*   Special Events (Halloween, Summer Festival, Christmas)
*   Other Inputs By User (Can Be Anything)



However, users are allowed to select multiple options from the list above and hence, we cannot plot the bar graph immediately. We need to perform some data cleaning and manipulation first before visualizing.

First, we need to identify all the unique categories of `q10` as some users might have inputted their preferred days under the "Other Inputs By User" section of the survey question.
"""

# Replace "Special Events (...)" with "Special Events" using regex
q10_column = df['q10'].replace(r'Special Events \(.*\)', 'Special Events', regex=True)

# Merge all values in q10_column into a list
q10_list = q10_column.tolist()

# Flatten the list by splitting each entry by commas and then flattening it
flattened_list = [item.strip() for sublist in q10_list for item in sublist.split(',')]

# Find unique categories
unique_categories = set(flattened_list)
print(unique_categories)

"""We observe that there are other entries such as 'When I feel like it' and '1 day in 25 years' that are in the resulting set of unique values, but are not available in the fixed options in the survey.

Data Cleaning Process:

1) Extract the `q10` column of the dataset

2) Separate the options using the comma delimiter for entries with more than 1 option

3) Performing One-Hot Encoding to create new columns - `weekdays`, `weekends`, `public_holidays`, `school_holidays` and `special_events` and others in the set containing 0 for absence and 1 for presence

4) Count the total number of 1's for each column of the 7 new columns created
"""

# Step 1: Extract the q10 column from the dataset
q10_column = df['q10']

# Replace "Special Events (...)" with "Special Events" using regex
q10_column = q10_column.replace(r'Special Events \(.*\)', 'Special Events', regex=True)

# Step 2: Separate the options using the comma delimiter for entries with more than 1 option
# We will split the entries and expand them into separate rows and then get the unique values
split_q10 = q10_column.str.split(',', expand=True)

# Step 3: Perform One-Hot Encoding
# Define the categories we want to create columns for
categories = ['Weekdays', 'Weekends', 'Public Holidays',
              'School Holidays', 'Special Events', 'When I feel like it',
              '1 day in 25 years']

# Create a new dataframe with columns for each category
one_hot_df = pd.DataFrame(0, index = df.index, columns = categories)

# Step 4: Fill the new columns with 1s where the category is present
for category in categories:
    one_hot_df[category] = split_q10.apply(lambda row: 1 if category in row.values else 0, axis = 1)

# Step 5: Count the total number of 1's for each new column created
count_ones = one_hot_df.sum()

# Display the result
print("Total Count Of Preferred Day Of Visitation:\n")
print(count_ones)

"""We can see that there are 7 unique categories, but two of them - "When I feel like it" and "1 day in 25 years" contain only one response, so we will exclude these two categories. We will proceed to plot a bar chart showcasing the total count for the remaining 5 categories having considerable number of responses."""

# Remove the "When I feel like it" and "1 day in 25 years" categories
count_ones = count_ones.drop(['When I feel like it', '1 day in 25 years'])

# Sort the count_ones in descending order
count_ones = count_ones.sort_values(ascending = False)

# Plot the bar chart with a color
plt.figure(figsize = (10, 8))
ax = count_ones.plot(kind = 'bar', color = "skyblue")

# Add labels and title
plt.title('Total Count of Preferred Day of Visitation (Current Data)')
plt.xlabel('Day Type')
plt.ylabel('Number Of Respondants')
plt.xticks(rotation = 45, ha = 'right')

# Step 7: Add number labels on top of the bars
for i in range(len(count_ones)):
    ax.text(i, count_ones.iloc[i] + 2, str(count_ones.iloc[i]), ha = 'center',
            va = 'bottom', fontsize = 10)

# Show the plot
plt.show()

"""Key Observations And Insights:

1) Weekdays have the largest number of respondants (138), indicating that the majority of visitors might choose a weekday to visit USS. There might be several reasons such as avoiding large crowds on weekends and public holidays or that there might be certain promotions or discounts given on weekdays that entice customers to visit USS on a weekday instead.

2) School Holidays also contribute to a significant number of responses (108) probably because there are many school children and teenagers who are only able to visit USS in this period due to their school/work days.

3) Special Events account for the lowest number of respondants (77). This might be attributed to the fact that there are only some special events held in USS and some visitors might have visited other entertainment venues (not USS) in these occasions.

--------------------------------------------------------------------------------

###### Category 2:

For the second category of "What time of the day constitutes the highest demand?", we can make use of several columns of the dataset to answer the question. This question targets the time aspect of visitation.

The columns that we will consider include:

*   `q14_1`: At what time of the day do you usually visit roller coasters?
*   `q14_2`: At what time of the day do you usually visit water rides?
*   `q14_3`:	At what time of the day do you usually visit 3D/4D experiences?
*   `q14_4`:	At what time of the day do you usually visit performances?
*   `q14_5`:	At what time of the day do you usually visit roadshows?
*   `q14_6`:	At what time of the day do you usually visit eateries and restaurants?
*   `q14_7`:	At what time of the day do you usually visit souvenir shops?
*   `q14_8`:	At what time of the day do you usually visit other rides (carousel rides, teacup rides etc.)?


**However, these columns selected target the popular times for each attraction, which we are not focusing on for this business question. We are instead focusing on the most popular timings in USS in general (not specific to each attraction). Instead, we should modify the columns above such that we calculate the combined count of each time category for all the eight columns.**

We can make use of another bar graph to plot the number of responses who select the possible options below.

The Possible Options Include:

*   Early Morning (8am to 10am)
*   Late Morning (10am to 12pm)
*   Early Afternoon (12pm to 2pm)
*   Late Afternoon (2pm to 4pm)
*   Evening (4pm to 6pm)
*   Night (6pm to 9pm)
*   I Do Not Visit

For these questions, users are not allowed to select any other option or type other suitable timings. Hence, there are only six categories that we will consider.
"""

# Extract the relevant columns for time ranges
popular_time_range = df[['q14_1', 'q14_2', 'q14_3', 'q14_4', 'q14_5', 'q14_6', 'q14_7', 'q14_8']]

# Flatten the DataFrame and split entries with commas into separate values
flattened_time_range = popular_time_range.values.flatten()

# Split by commas for entries with multiple options
split_time_range = [item.strip() for sublist in flattened_time_range for item in str(sublist).split(',')]

# Convert to a pandas Series for easier counting
time_range_series = pd.Series(split_time_range)

# Count the occurrences of each time slot
time_slot_counts = time_range_series.value_counts()

# Display the results
print("Combined Total Count for Each Time Slot:")
print(time_slot_counts)

"""From the result count obtained, we can see that the data is not clean and there are several entries that do not fit into the seven given categories. The improper results include 10 null values, 3 "i Do Not Visit" entries where the letter i is in small letter and a "Lunch (11am to 2pm)" entry with the wrong time period.

We need to process this further by:

1) Removing all the incorrect entries

2) All the number of "i Do Not Visit" entries, which is 3, to the "I Do Not Visit" entry
"""

# Remove invalid entries
time_slot_counts = time_slot_counts[~time_slot_counts.index.isin(['', 'Lunch (11am to 2pm)', 'i Do Not Visit'])]

# Add 3 to the count of "I Do Not Visit"
time_slot_counts = time_slot_counts.rename(index = {'i Do Not Visit': 'I Do Not Visit'})
time_slot_counts['I Do Not Visit'] += 3

# Display the cleaned results
print("Cleaned Combined Total Count for Each Time Slot:\n")
print(time_slot_counts)

"""The result is now cleaned and correct and we can proceed to plot the bar graph. We will order the bars of the graph by the time of the day - Leftmost bar represents Early Morning (8am to 10am) and the rightmost bar represents Night (6pm to 9pm). Also, we will exclude the I Do Not Visit entries as we are only interested in the visitation timings of USS.

**NOTE: The y-axis values of the bars do not truly reflect the actual number of respondants who visited USS due to the manipulation of the column values, as well as it is not possible for a certain visitor to be in multiple attractions at one time. There might be certain inaccuracies. Instead, we will just note the trend of the bars over time from early morning to night and observe which bars are the longest/shortest.**
"""

# Remove the "I Do Not Visit" category for plotting
time_slot_counts = time_slot_counts.drop(['I Do Not Visit'])

# Define the desired order of time categories
order = ["Early Morning (8am to 10am)", "Late Morning (10am to 12pm)",
         "Early Afternoon (12pm to 2pm)", "Late Afternoon (2pm to 4pm)",
         "Evening (4pm to 6pm)", "Night (6pm to 9pm)"]

# Reindex the time_slot_counts to ensure the desired order
time_period_counts = time_slot_counts.reindex(order, fill_value=0)

# Convert index to categorical with specified order
time_period_counts.index = pd.Categorical(time_period_counts.index,
                                          categories = order, ordered = True)

# Create a bar plot
plt.figure(figsize = (10, 8))
ax = sns.barplot(x = time_period_counts.index, y = time_period_counts.values,
                 order = order)

# Add title and labels
plt.title('Number Of Visitations Based On Time Periods (Current Data)')
plt.xlabel('Time Periods')
plt.ylabel('Number of Respondents')

# Rotate x-axis labels for better readability
plt.xticks(rotation = 30, ha = 'right')

# Add grid lines for better readability
plt.grid(axis = 'y', linestyle = '--', alpha = 0.3)

# Add number labels on top of bars
for i, value in enumerate(time_period_counts.values):
    ax.text(i, value + 1, str(value), ha='center', va='bottom', fontsize=10)

# Show the plot
plt.show()

"""Key Observations And Insights:

1) We observe that based on the length of the bars, Late Afternoon (2pm to 4pm) is the period of time where USS is the most crowded and has the most number of visitors. This is followed by Evening (4pm to 6pm) and Early Afternoon (12pm to 2pm). We can conclude that the peak times of USS span from Midday to around 6pm in the evening.

2) The least popular timing is Early Morning (8am to 10am) when USS just opens and might be still too early for some individuals who might be asleep at this timing. Demand is not as high. Night (6pm to 9pm) also has a lower number of respondants as it might be too late for some individuals possibly due to the fact that they might have work/school the next day.

--------------------------------------------------------------------------------

##### Special Events

To investigate the impact of special events on visitors, we will first analyze column `q7` (What are the factors that will influence your decision to visit a theme park like USS?) to see if `Special Events` is an important factor to survey respondants.

`q7` consists of the following options, where survey respondants are allowed to choose several options:

*   Weather Conditions
*   Holiday Seasons
*   Wait Times For Rides
*   Attraction Variety
*   **Special Events**
*   Cost And Ticket Prices
*   Location And Accessibility
*   Reputation And Reviews
*   Safety And Cleanliness
*   Other inputs by respondants

First, we will identify the unique categories of `q7` using the `.unique()` method
"""

# Merge all values in q7_column into a list
q7_column = df['q7']
q7_list = q7_column.tolist()

# Flatten the list by splitting each entry by commas and then flattening it
flattened_list = [item.strip() for sublist in q7_list for item in sublist.split(',')]

# Find unique categories
unique_categories = set(flattened_list)
print(unique_categories)

"""We observe that there are other entries such as `Whether I am working or not!` and `Thrill factor (not to be confused with scare factor` that are in the resulting set of unique values, but are not available in the fixed options in the survey.

Data Cleaning Process:

1) Extract the `q7` column of the dataset

2) Replace all `Holiday seasons` with `Holiday Seasons` and replace all `Weather conditions` with `Weather Conditions`

3) Separate the options using the comma delimiter for entries with more than 1 option

4) Performing One-Hot Encoding to create new columns containing 0 for absence and 1 for presence

5) Count the total number of 1's for each of the new columns created
"""

# Step 1: Extract the q7 column from the dataset
q7_column = df['q7']

# Step 2: Replace "Holiday seasons" with "Holiday Seasons" and "Weather conditions" with "Weather Conditions"
q7_column = q7_column.replace({'Holiday seasons': 'Holiday Seasons',
                               'Weather conditions': 'Weather Conditions'})

# Step 3: Separate the options using the comma delimiter for entries with more than 1 option
# We will split the entries and expand them into separate rows and then get the unique values
split_q7 = q7_column.str.split(',', expand=True).apply(lambda x: x.str.strip())

# Step 4: Perform One-Hot Encoding
# Define the categories we want to create columns for
categories = ['Weather Conditions', 'Holiday Seasons', 'Wait Times For Rides',
              'Attraction Variety', 'Special Events', 'Cost And Ticket Prices',
              'Location And Accessibility', 'Reputation And Reviews',
              'Safety And Cleanliness', 'Whether I am working or not!',
              'Aesthetics', 'Thrill factor (not to be confused with scare factor)']

# Create a new dataframe with columns for each category
one_hot_df = pd.DataFrame(0, index = df.index, columns = categories)

#Fill the new columns with 1s where the category is present
for category in categories:
    one_hot_df[category] = split_q7.apply(lambda row: 1 if category in row.values else 0, axis = 1)

# Step 5: Count the total number of 1's for each new column created
count_ones = one_hot_df.sum()

# Display the result
print("Total Count Of Factors Affecting Visitation:\n")
print(count_ones)

"""We observe that there are several entries such as "Whether I am working or not!", "Aesthetics" and "Thrill Factor" there have only a count of 1 and can be excluded from the analysis. Excluding the 3 factors with a count of 1, we will now plot a bar chart for the remaining columns."""

# Remove the categories with count = 1
count_ones = count_ones.drop(['Whether I am working or not!', 'Aesthetics',
                              'Thrill factor (not to be confused with scare factor)'])

# Sort the count_ones in descending order
count_ones = count_ones.sort_values(ascending = False)

print(count_ones)

# Define bar colors: magenta for "Special Events", blue for others
colors = ['magenta' if index == "Special Events" else 'blue' for index in count_ones.index]

# Create the bar plot with customized colors
plt.figure(figsize=(12, 8))
ax = count_ones.plot(kind='bar', color=colors)

# Add labels and title
plt.title('Total Count of Each Factor Influencing Theme Park Visitation')
plt.xlabel('Factors')
plt.ylabel('Number of Respondents')
plt.xticks(rotation=45, ha='right')

# Add number labels on top of the bars
for i in range(len(count_ones)):
    ax.text(i, count_ones.iloc[i] + 2, str(count_ones.iloc[i]), ha='center',
            va='bottom', fontsize=10)

# Add grid lines for better readability
plt.grid(axis='y', linestyle='--', alpha=0.3)

# Show the plot
plt.show()

"""The bar chart above suggests that `Special Events` may not be as important as other factors such as `Cost And Ticket Prices` and `Weather Conditions` in influencing survey respondants to visit theme parks. However, it is still a factor taken into consideration by 29% of respondants.

To further investigate which particular special events attract visitors, we will analyze column `q8` (What type of events influence your decision to visit?), which consists of the following options:

*   **Minion Land Grand Opening**
*   **Halloween Horror Night**
*   **A Universal Christmas**
*   **None Of The Above**

Since respondants are allowed to choose several options, we will perform One-Hot Encoding, then use a bar chart to visualize the total count for each option.
"""

# Step 1: Extract the q7 column from the dataset
q8_column = df['q8']

# Step 2: Separate the options using the comma delimiter for entries with more than 1 option
# We will split the entries and expand them into separate rows and then get the unique values
split_q8 = q8_column.str.split(',', expand=True).apply(lambda x: x.str.strip())

# Step 3: Perform One-Hot Encoding
# Define the categories we want to create columns for
categories = ['Minion Land Grand Opening',
              'Halloween Horror Night',
              'A Universal Christmas',
              'None Of The Above']

# Create a new dataframe with columns for each category
one_hot_df = pd.DataFrame(0, index = df.index, columns = categories)

#Fill the new columns with 1s where the category is present
for category in categories:
    one_hot_df[category] = split_q8.apply(lambda row: 1 if category in row.values else 0, axis = 1)

# Step 4: Count the total number of 1's for each new column created
count_ones = one_hot_df.sum()

# Display the result
print("Total Count Of Factors Affecting Visitation:\n")
print(count_ones)

# Sort the count_ones in descending order
count_ones = count_ones.sort_values(ascending = False)

# Plot the bar chart with a color
plt.figure(figsize = (12, 8))
ax = count_ones.plot(kind = 'bar', color='plum')

# Add labels and title
plt.title('Total Count of Events Attracting Visitors')
plt.xlabel('Events')
plt.ylabel('Number Of Respondents')
plt.xticks(rotation = 45, ha = 'right')

# Add number labels on top of the bars
for i in range(len(count_ones)):
    ax.text(i, count_ones.iloc[i] + 2, str(count_ones.iloc[i]), ha = 'center',
            va = 'bottom', fontsize = 10)

# Add grid lines for better readability
plt.grid(axis='y', linestyle='--', alpha=0.3)

# Show the plot
plt.show()

"""Key Observations And Insights:

From the bar chart above, we observe that `Halloween Horror Night` is most likely to attract guests to visit USS, followed by `Minion Land Grand Opening` then `A Universal Christmas`, but the difference in total count between the 3 events is not large. A point to note is that `Minion Land Grand Opening` is a one-time event while `Halloween Horror Night` and `A Universal Christmas` are annual events. On the other hand, about 36% of survey respondents are not interested in any of the above events.

--------------------------------------------------------------------------------

##### Satisfaction Ratings

To analyze the guest satisfaction of USS of recent survey respondents, we will be using column `q15` (How likely are you to recommend USS to others?) of the dataset. This column consists of scores from 1-10, where a score of 1 means that respondents are not at all likely to recommend USS to others while a score of 10 means that respondents are extremely likely to recommend USS to others
"""

# Extracting the relevant column for analysis (q15)
df_satisfaction_scores = df['q15']

# Create a count of values in q15
q15_counts = df_satisfaction_scores.value_counts().sort_index()

# Create the bar plot
plt.figure(figsize = (10, 8))
ax = sns.barplot(x = q15_counts.index, y = q15_counts.values)

# Add count labels on top of each bar
for p in ax.patches:
    ax.annotate(f'{int(p.get_height())}', (p.get_x() + p.get_width() / 2., p.get_height()),
                ha='center', va='center', xytext=(0, 10), textcoords='offset points')

# Add title and labels
plt.title('Overall Satisfaction Score Of USS')
plt.xlabel('Satisfaction Score (1-10)')
plt.ylabel('Number Of Respondents')

# Add grid lines for better readability
plt.grid(axis = 'y', linestyle = '--', alpha = 0.7)

# Show the plot
plt.show()

"""Referring to the Net Promoter Score (NPS) metric, 95 out of 507 survey respondents are promoters (gave a rating of 9 or 10), suggesting that only about 18.8% of them were satisfied with their experience at USS. About 53% of survey respondents gave scores of 7 and 8, which means that they would not strongly recommend others to visit USS. This indicates that slightly over half of the survey respondents were not very satisfied with their experience at USS, leading to an indifferent score.

++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

#### Step 2: Obtain And Analyze The Demographics Of Visitors Who Visited USS Some Time Ago

After analyzing the demographics of current visitors to Universal Studios Singapore (USS), we will now extend our analysis to past visitors.

To achieve this, we will utilize a survey dataset from Kaggle, which contains visitor data for various Universal Studios locations worldwide from 2010 to 2021 (spanning approximately 4 to 14 years ago). The dataset is made by combining all the reviews on Trip Advisor for the various Universal Studios around the world. This dataset will serve as our historical reference for examining visitor demographics and satisfaction scores. However, before proceeding with the analysis, we must first clean and preprocess the data to ensure accuracy and reliability.
"""

# Specify the file path of the excel file
file_path_two = '/content/drive/MyDrive/uss_historical_reviews.xlsx'

# Read the excel file into Google Colab using read_excel
df_history = pd.read_excel(file_path_two)

# Display the first few rows of the dataset
print(df_history.head())

"""The dataset contains 12 columns:

1. `reviewer` - The name of the reviewer (might not be real name)
2. `Gender` - The gender of the reviewer
3. `Age Range` - The age range of the reviewer
4. `Tourist or Local` - Whether the reviewer is a tourist or a local
5. `branch` - The Universal Studios branch the reviewer went
6. `time_of_day` - The time the reviewer prefers to go to USS
7. `visitor_type` - Who does the visitor go with (Family, Friends, Alone etc.)
8. `day_preferred` - What day does the reviewer prefer to go to USS
9. `written-date` - The time when the reviewer wrote the review
10. `rating` - The rating the reviewer gave to his/her Universal Studios Experience
11. `title` - The title the reviewer wrote on Trip Advisor
12. `review_text` - The review description that the reviewer gave on Trip Advisor

Let us examine the dataset more:

We can first find the total number of rows of the dataset using the `shape` method.
"""

# Determining the number of rows and columns of the dataset
print("Shape Of The Historical Dataset\n")
print(df_history.shape)

"""The dataset contains 50904 rows.

Next, we will examine the unique values of several of the categorical columns of the dataset to check for any anomaly values. These categorical columns include the branch (`branch`), the age range (`Age Range`), the gender (`Gender`), the nationality (`Tourist or Local`), the preferred day (`day_preferred`), the time preferred (`time_of_day`) and the visitor type (`visitor_type`).


"""

# Unique Values For Branch Column
print("Unique Values For Branch Column:")
print(df_history['branch'].unique())
print()

# Unique Values For Age Range Column
print("Unique Values For Age Range Column:")
print(df_history['Age Range'].unique())
print()

# Unique Values For Gender Column
print("Unique Values For Gender Column:")
print(df_history['Gender'].unique())
print()

# Unique Values For Nationality Column
print("Unique Values For Nationality Column:")
print(df_history['Tourist or Local'].unique())
print()

# Unique Values For Preferred Day
print("Unique Values For Preferred Day Column:")
print(df_history['day_preferred'].unique())
print()

# Unique Values For Time Of Day
print("Unique Values For Time Of Day Column:")
print(df_history['time_of_day'].unique())
print()

# Unique Values Fpr Visitor Type
print("Unique Values For Visitor Type Column:")
print(df_history['visitor_type'].unique())

"""We observe that that there are indeed no anomalies in these columns of the dataset. There are three branches available in the dataset - Universal Studios Florida, Universal Studios Japan and Universal Studios Singapore. For the other columns of the historical dataset, it tallies with the columns of our current survey dataset, so no additonal cleaning to remove anomalies is required for this portion.

To clean the raw dataset from Kaggle, we need to do the following:

*   Remove Unnecessary Columns - `reviewer`, `title`, `review_text` and `written_date`
*   Filter The Dataset For Rows Where `branch` is "Universal Studios Singapore" as we are not interested in other Universal Studios.
*   Rename Column Names For Consistency (`Gender` to `gender`, `Tourist or Local` to `nationality`, `Age Range` to `age_range`)
*   Rearrange The Columns Of The Dataset Where The Order Is - `gender`, `age_range`, `nationality`, `branch`, `visitor_type`, `day_preferred`, `time_of_day`, `rating`)
"""

# Remove unnecessary columns
df_history = df_history.drop(columns=['reviewer', 'title', 'review_text'])

# Filter for rows where 'branch' is "Universal Studios Singapore"
df_history = df_history[df_history['branch'] == "Universal Studios Singapore"]

# Rename columns for consistency
df_history = df_history.rename(columns={
    'Gender': 'gender',
    'Tourist or Local': 'nationality',
    'Age Range': 'age_range'
})

# Rearrange the columns in the specified order
df_history = df_history[['gender', 'age_range', 'nationality', 'branch', 'visitor_type',
                         'day_preferred', 'time_of_day', 'rating', 'written_date']]

# Get year and month of review
df_history['year'] = df_history['written_date'].dt.year
df_history['month'] = df_history['written_date'].dt.month

# Drop written_date column
df_history = df_history.drop(columns='written_date')

# Reset the index and start from 1 instead of 0
df_history = df_history.reset_index(drop=True)
df_history.index += 1

# Display the first few rows
print(df_history.head())

# Determining the number of rows and columns of the cleaned dataset
print("Shape Of The Cleaned Historical Dataset\n")
print(df_history.shape)

"""We observe that the number of columns of the dataset is reduced to 8 - which tallies with the columns of `gender`, `age_range`, `nationality`, `branch`, `visitor_type`, `day_preferred`, `time_of_day` and `rating`. The number of rows has also been reduced significantly from 50904 rows to 15754 rows due to the fact that we only kept rows containing survey responses from Universal Studios Singapore. This also agrees with the fact that the original dataset contains only about 35% of reviews from Universal Studios Singapore.

Using this cleaned dataset, we can now proceed to analyze the demographics and satisfaction rates of customers who visited USS some time ago.

##### Visitor Demographics

###### Age Of Visitors:
"""

# Extract the age_range column
dfhistory_agerange = df_history['age_range']

# Define the desired order of age categories
order = ["Below 12 Years Old", "13 To 20 Years Old", "21 To 34 Years Old",
         "35 To 49 Years Old", "50 To 64 Years Old", "65 Years Old And Above"]

# Count occurrences and reindex to match the desired order
ages = dfhistory_agerange.value_counts().reindex(order, fill_value=0)

# Convert index to categorical with specified order
person_type_counts.index = pd.Categorical(ages.index, categories=order, ordered=True)

# Create a bar plot
plt.figure(figsize=(10, 6))
ax = sns.barplot(x=ages.index, y=ages.values, order=order)

# Add title and labels
plt.title('Number Of Respondants Based On Age Range (Historical Data)')
plt.xlabel('Age Range Categories')
plt.ylabel('Number of Respondents')

# Rotate x-axis labels for better readability
plt.xticks(rotation=30, ha='right')

# Add grid lines for better readability
plt.grid(axis='y', linestyle='--', alpha=0.3)

# Add number labels on top of bars
for i, value in enumerate(ages.values):
    ax.text(i, value + 1, str(value), ha='center', va='bottom', fontsize=10)

# Show the plot
plt.show()

"""Key Observations And Insights:

1) We observe that contrary to the current visitor dataset where 21 to 34 years old (Young Adults) forms the majority of the survey responses, the historical visitor data reveals that the majority of visitors are in the age range of 13 to 20 years old (Teenagers).

2) The age range of 21 to 34 years old still form a significant proportion of the visitors in the historical data. The downward trend from the category of 21 to 34 years old to 65 years old ad above is similar to that of the current survey data.

3) The age group that has the lowest number of respondants is still 65 years and above, similar to the current survey data.

--------------------------------------------------------------------------------

###### Gender Of Visitors:
"""

# Extract gender column
dfhistory_gender = df_history['gender']

# Count the number of Male and Female in dataset
gender_counts_h = dfhistory_gender.value_counts()

# Define colors: Blue for Male, Pink for Female
colors = ['#377eb8', '#ff69b4']
#377eb8
# Create a pie chart
plt.figure(figsize = (9, 9))
plt.pie(gender_counts_h, labels = gender_counts_h.index, autopct = '%1.1f%%',
        colors = colors, startangle = 90, wedgeprops = {'edgecolor': 'black'})

# Add title
plt.title('Proportion of Male and Female Participants (Historical Data)')

# Add legend
plt.legend(title = "Gender", loc = "best")

# Show the plot
plt.show()

"""Key Observations Ans Insights:

Contrary to the current visitor survey responses where Females make up the majority of data, for the historical visitor survey responses, Male (67.7%) makes up most of the data as compared to Female (32.3%).

This shows that over time, there might either be:

**1) More Females interested in visiting USS**

**2) Less Males interested in visiting USS**

**3) Both (1) and (2)**

We will discuss more about this in Steps 3 and 4 of the question.

--------------------------------------------------------------------------------

###### Nationality Of Visitors
"""

# Extract nationality column
dfhistory_nationality = df_history['nationality']

# Count the number of Locals and Tourists in dataset
nationality_counts_h = dfhistory_nationality.value_counts()

# Define colors: Salmon Red for Local, Pastel Blue for Tourist
colors = ['#AEC6CF', '#FA8072']
#FA8072
# Create a pie chart
plt.figure(figsize = (9, 9))
plt.pie(nationality_counts_h, labels = nationality_counts_h.index, autopct = '%1.1f%%',
        colors = colors, startangle = 90, wedgeprops = {'edgecolor': 'black'})

# Add title
plt.title('Proportion of Locals And Tourists (Historical Data)')

# Add legend
plt.legend(title = "Nationality Type", loc = "best")

# Show the plot
plt.show()

"""Key Observations Ans Insights:

Contrary to the current visitor survey responses where Locals make up the majority of data, for the historical visitor survey responses, Tourists (65.7%) makes up most of the data as compared to Locals (34.3%).

This shows that over time, there might either be:

**1) More Locals interested in visiting USS**

**2) Less Tourists interested in visiting USS**

**3) Both (1) and (2)**

We will discuss more about this in Steps 3 and 4 of the question.

--------------------------------------------------------------------------------

##### Visitor Type

We will use the `visitor_type` column of the historical dataset to explore the distribution of visitor types in the past.
"""

# Specify order
order = ['Solo Traveller', 'Visiting With Friends', 'Families With Young Children',
         'Families With Teenagers', 'Families With Elderly']

# Create a bar plot
plt.figure(figsize=(10, 6))
ax = sns.countplot(x='visitor_type', data=df_history, order=order, color="powderblue")

# Add title and labels
plt.title('Number Of Reviewers Based On Visitor Type (Historical Data)')
plt.xlabel('Visitor Categories')
plt.ylabel('Number of Reviewers')

# Rotate x-axis labels for better readability
plt.xticks(rotation=30, ha='right')

# Add grid lines for better readability
plt.grid(axis='y', linestyle='--', alpha=0.3)

# Add number labels on top of bars
for p in ax.patches:
    ax.annotate(f'{int(p.get_height())}',
                (p.get_x() + p.get_width() / 2., p.get_height()),
                ha='center', va='bottom', fontsize=10)

# Show the plot
plt.show()

"""From the above bar chart, we observe that there is a significantly higher proportion of visitors who are `Families With Young Children`, as compared to the survey responses where the difference in proportion was not as significant. Another observation is that there is a higher proportion of `Families With Elderly` as compared to `Solo Travellers` and `Families With Teenagers`, which differs from our earlier analysis based on recent survey responses.

These differences could be explained by possible reasons below:

**1) Distributions of visitor types have shifted over the years due to marketing strategies or change in preferences**

**2) Limited survey outreach which resulted in skewed survey responses**

**3) Both (1) and (2)**

We will discuss more about this in Steps 3 and 4 of the question.

--------------------------------------------------------------------------------

##### Time Of Day

###### Category 1: When do visitors usually spend their day at USS?

We can use the `day_preferred` column of the historical dataset to identify the most common day type that previous visitors visit USS.
"""

# Extract the day_preferred column
dfhistory_day = df_history['day_preferred']

# Define the desired order
order = ["Weekdays", "Weekends", "Public Holidays", "School Holidays", "Special Events"]

# Count occurrences and reindex to match the desired order
days = dfhistory_day.value_counts().reindex(order, fill_value=0)

# Create a bar plot
plt.figure(figsize=(10, 6))
ax = sns.barplot(x=days.index, y=days.values, order=order, color="pink")

# Add title and labels
plt.title("Number of Respondents Based on Preferred Days (Historical Data)")
plt.xlabel("Day Categories")
plt.ylabel("Number of Respondents")

# Rotate x-axis labels for better readability
plt.xticks(rotation=30, ha="right")

# Add grid lines for better readability
plt.grid(axis="y", linestyle="--", alpha=0.3)

# Add number labels on top of bars
for i, value in enumerate(days.values):
    ax.text(i, value + 1, str(value), ha='center', va='bottom', fontsize=10)

# Show the plot
plt.show()

"""Key Observations And Insights:

1) For the historical data, the majority of respondants chose Weekends as their preferred days, in contrast to Weekdays for the current data. There might be a shift in the visitor' preferences from Weekends to Weekdays.

2) The number of reviewers who prefer visiting USS during Special Events is the least among the other options, similar to the current dataset. However, contrary to the current dataset, the historical data shows much less visitors whose preference is on Speical Events.

3) The proportion of visitors who chose School Holidays as their preferred days to visit USS for the historic dataset is significantly lower compared to the current dataset.

Next, we will explore the number of reviews received each month from 2010 to 2021 by plotting a line graph.
"""

# Group by year and month and count occurrences
monthly_counts = df_history.groupby(['year', 'month']).size().reset_index(name='count')

# Pivot for easier plotting
pivot_counts = monthly_counts.pivot(index='month', columns='year', values='count')

# Plot line graph
plt.figure(figsize=(12, 6))
sns.lineplot(data=monthly_counts, x='month', y='count', hue='year',
             marker='o', palette='deep', linewidth=2)

plt.title('Number of Reviews Each Month', fontsize=14)
plt.xlabel('Month', fontsize=12)
plt.ylabel('Number of Reviews', fontsize=12)
plt.xticks(range(1, 13),
           ['Jan', 'Feb', 'Mar', 'Apr', 'May', 'Jun',
            'Jul', 'Aug', 'Sep', 'Oct', 'Nov', 'Dec'])
plt.grid(True, linestyle='--', alpha=0.6)
plt.legend(title='Year', fontsize=10, bbox_to_anchor=(1.1, 1))
plt.tight_layout()

plt.show()

"""The graph shows that there tends to be spike in the number of reviews in the months of July and December to January for most years, with the exception of 2020 and 2021 when the pandemic was still rampant. This coincides with the long school holiday period in Singapore (June and December), suggesting that a larger number of people tend to visit USS during the holidays, even if it may not be their preferred choice.

--------------------------------------------------------------------------------

###### Category 2: What time of the day constitutes the highest demand?

We can use the `time_of_day` column of the historical dataset to identify the most common timings that previous visitors visit USS.
"""

# Extract the time_of_day column
dfhistory_time = df_history['time_of_day']

# Define the desired order of time categories
order = ["Early Morning (8am To 10am)", "Late Morning (10am To 12pm)",
         "Early Afternoon (12pm To 2pm)", "Late Afternoon (2pm To 4pm)",
         "Evening (4pm To 6pm)", "Night (6pm To 9pm)"]

# Count occurrences and reindex to match the desired order
timing = dfhistory_time.value_counts().reindex(order, fill_value=0)

# Create a bar plot
plt.figure(figsize=(10, 6))
ax = sns.barplot(x=timing.index, y=timing.values, order=order, color="orange")

# Add title and labels
plt.title("Number of Respondents Based on Preferred Timings (Historical Data)")
plt.xlabel("Time Categories")
plt.ylabel("Number of Respondents")

# Rotate x-axis labels for better readability
plt.xticks(rotation=30, ha="right")

# Add grid lines for better readability
plt.grid(axis="y", linestyle="--", alpha=0.3)

# Add number labels on top of bars
for i, value in enumerate(timing.values):
    ax.text(i, value + 1, str(value), ha='center', va='bottom', fontsize=10)

# Show the plot
plt.show()

"""Key Observations And Insights:

1) For the historical data, the majority of respondants chose Evening (4pm to 6pm) as their preferred timings to visit USS, in contrast to Late Afternoon (2pm to 4pm) for the current data. However, Late Afternoon (2pm to 4pm) still forms quite a significant proportion of visitors favorite timing for the historical data.  

2) The number of reviewers who prefer visiting USS during Early Morning (8am to 10am) and Night (6pm to 9pm) is the least among the other options, similar to the current dataset.  

3) The number of respondants still shows an increase from Early Morning (8am to 10am) to Late Afternoon (2pm to 4pm), similar to the current dataset.

--------------------------------------------------------------------------------

##### Special Events

We can use the `day_preferred` column of the historical dataset to identify how often previous visitors visit USS during special events as compared to other days.
"""

# Extract the day_preferred column
dfhistory_day = df_history['day_preferred']

# Define the desired order
order = ["Weekdays", "Weekends", "Public Holidays", "School Holidays", "Special Events"]

# Count occurrences and reindex to match the desired order
days = dfhistory_day.value_counts().reindex(order, fill_value=0)

# Create a bar plot
plt.figure(figsize=(10, 6))
ax = sns.barplot(x=days.index, y=days.values, order=order, color='powderblue')

# Add title and labels
plt.title("Number of Reviewers Based on Preferred Days (Historical Data)")
plt.xlabel("Day Categories")
plt.ylabel("Number of Reviewers")

# Rotate x-axis labels for better readability
plt.xticks(rotation=30, ha="right")

# Add grid lines for better readability
plt.grid(axis="y", linestyle="--", alpha=0.3)

# Add number labels on top of bars
for i, value in enumerate(days.values):
    ax.text(i, value + 1, str(value), ha='center', va='bottom', fontsize=10)

# Show the plot
plt.show()

"""Similar to current survey visitor responses, the number of reviewers who prefer visiting USS during `Special Events` is the least among the other options. However, we observe that this difference between `Special Events` and other options is more significant in the historical data as compared to data obtained from recent survey responses. This might be due to the fact that there might be more advertising of these special events by USS in recent years that led to greater demand for USS during these events.

--------------------------------------------------------------------------------

##### Satisfaction Ratings

We will be using the `ratings` column as a metric to measure guest satisfaction of TripAdvisor reviewers in the past. To visualize the distribution of ratings, we will plot a bar chart.

**NOTE: The `rating` column is measured from 1 to 5, which is different from the scale from 1 to 10 in the satisfaction score for the current dataset. For example, We will assume that a rating of 4 in the historic dataset will translate to a rating of 8 in the current dataset.**
"""

# Create a bar plot
plt.figure(figsize=(10, 6))
ax = sns.countplot(x='rating', data=df_history, color='darkgreen')

# Add count labels on top of each bar
for p in ax.patches:
    ax.annotate(f'{int(p.get_height())}', (p.get_x() + p.get_width() / 2., p.get_height()),
                ha='center', va='center', xytext=(0, 10), textcoords='offset points')

# Add title and labels
plt.title('Distribution of Ratings')
plt.xlabel('Ratings')
plt.ylabel('Number of Reviewers')

# Add grid lines for better readability
plt.grid(axis='y', linestyle='--', alpha=0.3)

# Show the plot
plt.show()

"""Key Observations And Insights:

1) As seen from the bar chart above, over 83% of reviewers gave USS a rating of 4 and 5 on TripAdvisor, suggesting that they were generally satisfied with their experience. A minority (5.4%) expressed their dissatisfaction by giving ratings of 1 and 2.

2) The ratings of USS historically is generally higher compared to the satisfaction ratings of USS currently (the mode rating for historic data is 5 but the mode rating for the current USS is 7/10, which is only between 3 and 4 when translated to a scale of 5). This means that overall satisfaction of USS fell in the recent years.

++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

#### Step 3: Compare The Visitor Demographics + Identify Trends And Majority Classes

For effective comparisons of visitor demographics, we can make use of heatmaps for every demographic section. We will be comparing proportions in the form of percentages (in 1 decimal place for all heatmapsfor consistency) instead of counts as the number of survey responses in the historic data far exceeds the number of survey responses in the current data (almost 15000 vs 500).

The sections that we will be comparing are:

**1.   Age Of Visitors**

**2.   Gender Of Visitors**

**3.   Nationality Of Visitors**

**4.   Visitor Type**

**5.   Preferred Days**

**6.   Preferred Timing**

###### Age Of Visitors:
"""

# Define age order
order = ["Below 12 Years Old", "13 To 20 Years Old", "21 To 34 Years Old",
         "35 To 49 Years Old", "50 To 64 Years Old", "65 Years Old And Above"]

# Compute proportions for current data
df_agerange = df['q2_1']
current_counts = df_agerange.value_counts().reindex(order, fill_value=0)
current_proportions = (current_counts / current_counts.sum() * 100).round(1)

# Compute proportions for historical data
dfhistory_agerange = df_history['age_range']
historic_counts = dfhistory_agerange.value_counts().reindex(order, fill_value=0)
historic_proportions = (historic_counts / historic_counts.sum() * 100).round(1)

# Combine into a DataFrame
heatmap_data = pd.DataFrame({'Current Data': current_proportions, 'Historical Data': historic_proportions})
annot_data = heatmap_data.astype(str) + "%"

# Create the heatmap
plt.figure(figsize=(8, 6))
sns.heatmap(heatmap_data, annot=annot_data, cmap="Reds", fmt="", linewidths=0.5)
plt.title("Age Group Proportions: Current vs. Historical Data")
plt.show()

"""This heatmap shows the age distribution of visitors comparing current versus historical data for USS

Looking at the data in detail:

Children (Below 12 Years Old):
*   Current: 16.8%
*   Historical: 15.3%
*   Slight increase in children visiting currently

Teenagers (13 To 20 Years Old):

*   Current: 25.0%
*   Historical: 24.7%
*   Almost unchanged, representing about a quarter of visitors in both periods

Young Adults (21 To 34 Years Old):

*   Current: 32.3%
*   Historical: 20.3%
*   Significant increase of 12 percentage points, making this the most dramatic change in the dataset

Middle-Aged Adults (35 To 49 Years Old):

*   Current: 14.3%
*   Historical: 19.6%
*   Notable decrease of about 5.3 percentage points

Older Adults (50 To 64 Years Old):

*   Current: 7.7%
*   Historical: 15.3%
*   Substantial decrease of 7.6 percentage points, showing this demographic has become much less represented

Seniors (65 Years Old And Above):


*   Current: 4.0%
*   Historical: 4.8%
*   Slight decrease, but remains the smallest proportion in both datasets

Key Trends:

The visitor population has significantly shifted toward younger adults (21-34), which now make up nearly a third of all visitors. There has been a marked decline in middle-aged and older adult visitors (35-64 age groups). The proportion of children and teenagers remains relatively stable between the two periods. The current visitor profile is more heavily skewed toward younger demographics, with 74.1% of visitors under 35 years old (compared to 60.3% historically). The 50+ age groups collectively dropped from 20.1% historically to just 11.7% currently.

This suggests a strategic repositioning or changing appeal of USS, with significantly stronger attraction to young adults and slightly reduced engagement with older demographics.

--------------------------------------------------------------------------------

###### Gender Of Visitors:
"""

# Compute gender proportions for current dataset
df_gender = df['q2_2']
current_counts = df_gender.value_counts()
current_proportions = (current_counts / current_counts.sum() * 100).round(1)

# Compute gender proportions for historical dataset
dfhistory_gender = df_history['gender']
historic_counts = dfhistory_gender.value_counts()
historic_proportions = (historic_counts / historic_counts.sum() * 100).round(1)

# Combine into a DataFrame
heatmap_data = pd.DataFrame({'Current Data': current_proportions, 'Historical Data': historic_proportions})
annot_data = heatmap_data.astype(str) + "%"

# Create the heatmap
plt.figure(figsize=(10, 6))
sns.heatmap(heatmap_data, annot=annot_data, cmap="Greens", fmt="", linewidths=0.5)
plt.title("Gender Proportions: Current vs. Historical Data")
plt.show()

"""This heatmap displays gender proportions comparing current versus historical data for USS.

The gender distribution shows a dramatic reversal between the two time periods:

Current Data:
*   Female: 61.0%
*   Male: 39.0%

Historical Data:
*   Female: 32.3%
*   Male: 67.7%

Key Trends:

There has been a complete inversion in the gender proportions between the historical and current periods. Historically, males dominated the visitor demographics, representing over two-thirds (67.7%) of all visitors.
Currently, females constitute the clear majority at 61.0% of visitors.
The shift represents a 28.7 percentage point increase in female representation.
Male representation has correspondingly decreased by 28.7 percentage points.

This significant gender proportion reversal suggests a possible fundamental change in either: The attraction's appeal or marketing strategy, the programming or exhibition content, targeted outreach efforts or the organizational culture or reputation.

--------------------------------------------------------------------------------

###### Nationality Of Visitors:
"""

# Compute nationality proportions for current dataset
df_nationality = df['q3']
current_counts = df_nationality.value_counts()
current_proportions = (current_counts / current_counts.sum() * 100).round(1)

# Compute nationality proportions for historical dataset
dfhistory_nationality = df_history['nationality']
historic_counts = dfhistory_nationality.value_counts()
historic_proportions = (historic_counts / historic_counts.sum() * 100).round(1)

# Combine into a DataFrame
heatmap_data = pd.DataFrame({'Current Data': current_proportions, 'Historical Data': historic_proportions})
annot_data = heatmap_data.astype(str) + "%"

# Create the heatmap
plt.figure(figsize=(10, 6))
sns.heatmap(heatmap_data, annot=annot_data, cmap="Blues", fmt="", linewidths=0.5)
plt.title("Nationality Proportions: Current vs. Historical Data")
plt.show()

"""This heatmap shows the nationality proportions comparing current versus historical data for USS, breaking down visitors into "Local" and "Tourist" categories.

Current Data:
*   Local: 55.2%
*   Tourist: 44.8%

Historical Data:
*   Local: 34.3%
*   Tourist: 65.7%

Key Trends:

There has been a significant shift in the visitor composition, with the proportions essentially inverting between the two time periods.Historically, tourists were the dominant visitor group, making up nearly two-thirds (65.7%) of all visitors. Currently, locals constitute the majority at 55.2% of visitors.
This represents a 20.9 percentage point increase in local visitation.
Tourist representation has correspondingly decreased by 20.9 percentage points.

This substantial change in the visitor demographic suggests:

A shift in focus toward attracting and serving the local community
Potentially reduced international or out-of-area tourism or a possible reorientation of programming or exhibits to appeal more to local interests. There couls also be changes in marketing strategy to target the local market.

--------------------------------------------------------------------------------

###### Visitor Type:
"""

# Standardize visitor type labels to match both datasets
order = ['Solo Traveller', 'Visiting With Friends', 'Family With Young Children',
         'Family With Teenagers', 'Family With Elderly']

# Replace 'Families' with 'Family' in historical data for consistency
df_history['visitor_type'] = df_history['visitor_type'].replace({
    'Families With Young Children': 'Family With Young Children',
    'Families With Teenagers': 'Family With Teenagers',
    'Families With Elderly': 'Family With Elderly'
})

# Compute visitor type proportions for current dataset
current_counts = df['q1'].value_counts().reindex(order, fill_value=0)
current_proportions = (current_counts / current_counts.sum() * 100).round(1)

# Compute visitor type proportions for historical dataset
historic_counts = df_history['visitor_type'].value_counts().reindex(order, fill_value=0)
historic_proportions = (historic_counts / historic_counts.sum() * 100).round(1)

# Combine into a DataFrame
heatmap_data = pd.DataFrame({'Current Data': current_proportions, 'Historical Data': historic_proportions})
annot_data = heatmap_data.astype(str) + "%"

# Create the heatmap
plt.figure(figsize=(8, 6))
sns.heatmap(heatmap_data, annot=annot_data, cmap="Purples", fmt="", linewidths=0.5)
plt.title("Visitor Type Proportions: Current vs. Historical Data")
plt.show()

"""This heatmap illustrates the visitor type proportions comparing current versus historical data for USS, breaking down visitors into five distinct categories.

Current Data:

*   Solo Traveller: 18.8%
*   Visiting With Friends: 25.9%
*   Family With Young Children: 29.1%
*   Family With Teenagers: 20.8%
*   Family With Elderly: 5.3%

Historical Data:

*   Solo Traveller: 13.0%
*   Visiting With Friends: 19.0%
*   Family With Young Children: 37.2%
*   Family With Teenagers: 12.9%
*   Family With Elderly: 18.0%

Key Trends:



1.   "Family With Young Children" remains the largest visitor segment in both periods, though it has decreased by 8.1 percentage points (from 37.2% to 29.1%).
2.   "Visiting With Friends" has increased significantly from 19.0% to 25.9%, suggesting USS has become more popular as a social destination.
3.   "Family With Elderly" has seen the most dramatic decrease, dropping from 18.0% to just 5.3% (a 12.7 percentage point decline).
4.  "Family With Teenagers" has increased substantially from 12.9% to 20.8%, an 8.1 percentage point increase.
5.  "Solo Traveller" visitation has increased from 13.0% to 18.8%.


These changes align with the previous demographic shifts observed:

The decline in elderly family visits corresponds with the overall reduction in older visitors. The increase in friend groups and solo travelers aligns with the shift toward younger adults (21-34). The growth in teenage family visits matches the stable proportion of teenage visitors we saw in the age breakdown.
Overall, USS has transitioned from being primarily a family destination (particularly for young children and elderly family members) to a more diversified attraction that appeals to varied groups, especially friends, solo visitors and families with teenagers.

--------------------------------------------------------------------------------

###### Preferred Days:
"""

# Code From Just Now (Repeated)
q10_column = df['q10']
q10_column = q10_column.replace(r'Special Events \(.*\)', 'Special Events', regex=True)
split_q10 = q10_column.str.split(',', expand=True)
categories = ['Weekdays', 'Weekends', 'Public Holidays', 'School Holidays',
              'Special Events', 'When I feel like it', '1 day in 25 years']
one_hot_df = pd.DataFrame(0, index=df.index, columns=categories)
for category in categories:
    one_hot_df[category] = split_q10.apply(lambda row: 1 if category in row.values else 0, axis=1)
count_ones = one_hot_df.sum()
count_ones = count_ones.drop(['When I feel like it', '1 day in 25 years'])

# Normalize the count to get proportions (convert to percentage)
current_proportions = (count_ones / count_ones.sum() * 100).round(1)

# Compute preferred day proportions for historical dataset
dfhistory_day = df_history['day_preferred']
days = dfhistory_day.value_counts().reindex(categories[:5], fill_value=0)

# Normalize the historical count to get proportions (convert to percentage)
historic_proportions = (days / days.sum() * 100).round(1)

# Combine into a DataFrame
heatmap_data = pd.DataFrame({'Current Data': current_proportions, 'Historical Data': historic_proportions})
annot_data = heatmap_data.astype(str) + "%"

# Create the heatmap
plt.figure(figsize=(9, 6))
sns.heatmap(heatmap_data, annot=annot_data, cmap="Oranges", fmt="", linewidths=0.5)
plt.title("Preferred Day Proportions: Current vs. Historical Data")
plt.show()

"""This heatmap displays the preferred day proportions comparing current versus historical data for USS, showing when visitors prefer to attend.

Current Data:
*   Weekdays: 27.4%
*   Weekends: 19.5%
*   Public Holidays: 16.3%
*   School Holidays: 21.5%
*   Special Events: 15.3%


Historical Data:
*   Weekdays: 24.0%
*   Weekends: 29.6%
*   Public Holidays: 28.1%
*   School Holidays: 14.9%
*   Special Events: 3.4%

Key Trends:
1.   Visitor timing preferences have significantly shifted between the two periods, with much more evenly distributed attendance patterns now.
2.   Historically, attendance was concentrated during weekends (29.6%) and public holidays (28.1%), which together accounted for 57.7% of visitors.
3.   Currently, weekdays have become the most popular time to visit (27.4%), followed by school holidays (21.5%).
4.   Weekend visitation has decreased substantially from 29.6% to 19.5% (a 10.1 percentage point decline).
5.   Public holiday visitation has dropped significantly from 28.1% to 16.3% (an 11.8 percentage point decrease).
6.   Special events have seen a dramatic increase in popularity, rising from just 3.4% to 15.3% (an 11.9 percentage point increase).
7.   School holiday visitation has increased from 14.9% to 21.5% (a 6.6 percentage point rise).

These changes align with the demographic shifts observed in previous charts:

The increase in weekday and special event visitation correlates with the rise in local visitors who likely have more flexibility to visit on non-peak days. The growth in school holiday attendance matches the increase in families with teenagers. The decrease in weekend and public holiday visitation suggests less reliance on tourism and out-of-town visitors.

Overall, USS has transitioned from a destination primarily visited during traditional peak tourism periods (weekends and public holidays) to one with more balanced attendance throughout different time periods, with special emphasis on weekdays, school holidays, and special events.

--------------------------------------------------------------------------------

###### Preferred Timing:
"""

# Code From Just Now (Repeated)
popular_time_range = df[['q14_1', 'q14_2', 'q14_3', 'q14_4', 'q14_5', 'q14_6', 'q14_7', 'q14_8']]
flattened_time_range = popular_time_range.values.flatten()
split_time_range = [item.strip() for sublist in flattened_time_range for item in str(sublist).split(',')]
time_range_series = pd.Series(split_time_range)
time_slot_counts = time_range_series.value_counts()
time_slot_counts = time_slot_counts[~time_slot_counts.index.isin(['', 'Lunch (11am to 2pm)', 'i Do Not Visit'])]
time_slot_counts = time_slot_counts.rename(index = {'i Do Not Visit': 'I Do Not Visit'})
time_slot_counts['I Do Not Visit'] += 3
time_slot_counts = time_slot_counts.drop(['I Do Not Visit'])
order = ["Early Morning (8am to 10am)", "Late Morning (10am to 12pm)",
         "Early Afternoon (12pm to 2pm)", "Late Afternoon (2pm to 4pm)",
         "Evening (4pm to 6pm)", "Night (6pm to 9pm)"]
time_period_counts = time_slot_counts.reindex(order, fill_value=0)
current_proportions = (time_period_counts / time_period_counts.sum() * 100).round(1)
dfhistory_time = df_history['time_of_day']
dfhistory_time = dfhistory_time.replace({
    "Early Morning (8am To 10am)": "Early Morning (8am to 10am)",
    "Late Morning (10am To 12pm)": "Late Morning (10am to 12pm)",
    "Early Afternoon (12pm To 2pm)": "Early Afternoon (12pm to 2pm)",
    "Late Afternoon (2pm To 4pm)": "Late Afternoon (2pm to 4pm)",
    "Evening (4pm To 6pm)": "Evening (4pm to 6pm)",
    "Night (6pm To 9pm)": "Night (6pm to 9pm)"
})
timing = dfhistory_time.value_counts().reindex(order, fill_value=0)

# Normalize the historical count to get proportions (convert to percentage)
historic_proportions = (timing / timing.sum() * 100).round(1)

# Combine into a DataFrame
heatmap_data = pd.DataFrame({'Current Data': current_proportions, 'Historical Data': historic_proportions})
annot_data = heatmap_data.astype(str) + "%"

# Create the heatmap
plt.figure(figsize=(8, 6))
sns.heatmap(heatmap_data, annot=annot_data, cmap="Greys", fmt="", linewidths=0.5)
plt.title("Preferred Time Slot Proportions: Current vs. Historical Data")
plt.show()

"""This heatmap presents the preferred time slot proportions comparing current versus historical data for USS, showing when during the day visitors prefer to attend.

Current Data:
*   Early Morning (8am to 10am): 13.8%
*   Late Morning (10am to 12pm): 16.4%
*   Early Afternoon (12pm to 2pm): 17.7%
*   Late Afternoon (2pm to 4pm): 20.0%
*   Evening (4pm to 6pm): 17.9%
*   Night (6pm to 9pm): 14.3%

Historical Data:
*   Early Morning (8am to 10am): 14.6%
*   Late Morning (10am to 12pm): 15.0%
*   Early Afternoon (12pm to 2pm): 16.1%
*   Late Afternoon (2pm to 4pm): 18.4%
*   Evening (4pm to 6pm): 21.4%
*   Night (6pm to 9pm): 14.6%

Key Trends:

1.   The time slot preferences show relatively modest changes compared to the more dramatic shifts observed in other demographic categories.
2.   Late afternoon (2pm to 4pm) has become the most popular time slot currently at 20.0%, while evening (4pm to 6pm) was historically the most popular at 21.4%.
3.   Evening visitation has decreased from 21.4% to 17.9% (a 3.5 percentage point decline).
4.   The current distribution is more balanced across time slots, with no single time period strongly dominating.
5.   Early afternoon and late morning have seen modest increases in popularity (1.6 and 1.4 percentage points respectively).
6.   Early morning and night time slots remain the least popular periods in both datasets, with minimal changes.

These time slot preference changes align with the broader demographic shifts:

The more evenly distributed time preferences may reflect the greater proportion of local visitors who have more flexibility in their visiting times. The slight decline in evening visits could relate to the decrease in tourist visitors, who might previously have preferred to visit attractions later in the day. The increased popularity of afternoon slots aligns with the growth in family and friend group visits.

++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++++

#### Step 4: Implement Effective Strategies To Tailor To The Identified Groups

Before we propose effective strategies, we need to first determine the groups that are under-represented in the survey. This is to entice the groups of individuals who might initally not be interested in visiting USS in order to increase the overall demand for USS, as well as enhancing the guest experience at USS.

From the results obtained above, we can pinpoint certain groups that might not be visiting USS as much.

1. **The Elderly (Particularly 65 years and above)**
2. **Males (Dropping in proportions recently)**
3. **Tourists (Dropping in proportions recently)**

There are other groups of people that although still have fairly high proportions, it shows a downward trend from previous years. USS should also propose marketing strategies to entice these groups of people to continue visiting USS. These groups include

1.  **Families With Young Children (Dropped in proportions though still high)**
2.  **35 To 49 Year Olds (Working Adults)**

--------------------------------------------------------------------------------

**Elderly**

1. Senior Discount Days: Offer exclusive senior citizen discounts on weekdays or off-peak periods (e.g., "Senior Citizens’ Special: 20% Off Tickets Every Wednesday")

Offering senior discounts during off-peak times can help fill up the park during slower periods, increasing overall attendance. By targeting seniors, USS attracts a demographic that might otherwise avoid peak pricing. Seniors visiting on discounted days are likely to spend on additional services such as food, beverages, merchandise, and special experiences. The sense of savings from the discount encourages seniors to purchase tickets and additional items that they might not have otherwise.

2. Group Discounts for Senior Groups: Provide group pricing for seniors visiting with family or friends

Offering group discounts encourages seniors to visit USS with their families or friends, which can increase group ticket sales. Group visits often lead to higher spending since more people are on-site, and each individual tends to purchase food, drinks, and souvenirs. Additionally, seniors visiting with companions will likely make use of other park amenities (such as VIP tours, photo packages, and merchandise). By offering a lower price for senior groups, USS can attract larger parties, thus improving both ticket sales and overall park revenue through group purchases and shared experiences.

3. Relaxation Zones: Designate calming rest areas with comfortable seating, shade, and gentle music for seniors to relax in between attractions

Relaxation zones enhance the experience for elderly visitors, encouraging them to stay longer in the park without feeling fatigued. This added comfort can lead to increased spending on food, drinks, and souvenirs as seniors take breaks in these areas. The zones also provide a sense of exclusivity and care, which could result in more seniors choosing USS as their destination for leisure, leading to repeat visits. Creating a positive and comfortable environment for older guests can also foster word-of-mouth promotion, attracting new visitors from within the same demographic, boosting future revenue.

4. Senior-Friendly Tours: Offer guided, leisurely-paced tours around the park

Senior-friendly tours can be monetized by charging an additional fee for guided experiences, adding another revenue stream to USS. These tours cater specifically to the interests and pace of elderly visitors, which not only enhances their experience but also offers them something they might be willing to pay for. Seniors often appreciate leisurely, informative tours that are easy to follow, and offering them the chance to learn about the history of USS.

5. Accessible Services: Promote accessibility options like wheelchair rentals, mobility aids, and priority seating for shows

Providing accessible services like wheelchair rentals and priority seating ensures that elderly visitors, especially those with mobility issues, can fully enjoy the park without feeling restricted. The availability of mobility aids makes USS more inclusive, attracting a wider range of seniors, including those who may have previously thought the park was not accessible to them. By offering these services, USS not only increases the likelihood of senior visits but also generates additional revenue from rentals and premium services like priority seating.

--------------------------------------------------------------------------------

**Males**

1. Increase Action-Packed Themed Attractions and Events: Focus on high-adrenaline, action-oriented rides and experiences, such as those based on blockbuster action movies (e.g., Fast & Furious, Transformers, Jurassic Park)

Men often enjoy intense, thrilling experiences. By emphasizing action-packed attractions, USS can increase ticket sales as these types of experiences tend to attract larger crowds. Additionally, special events can be ticketed separately, generating extra revenue. Merchandise related to these events (e.g., superhero or movie-themed items) can also drive increased sales. High-adrenaline attractions also encourage repeat visits, especially if new features or events are added over time.

2. Partnerships with Popular Male-Oriented Brands: Partner with well-known male-oriented brands (e.g., sports brands, gaming companies, or popular men's lifestyle brands)

Brand partnerships can draw new visitors who are loyal to specific brands, leading to increased foot traffic and engagement. Co-branded merchandise (e.g., limited-edition items from a popular gaming brand) can be sold, providing additional revenue. Additionally, exclusive partnerships often generate buzz and marketing opportunities, leading to greater awareness and attendance from the target demographic.

3. Sports Bar and Gaming Lounges: Set up sports bars or gaming lounges within the park where male visitors can watch live sports events, play games, or relax while enjoying food and drinks

Sports bars and gaming lounges create an opportunity to increase F&B revenue by offering food and drink packages. These venues are attractive for groups of male visitors who can socialize, relax, and spend time at the park in between attractions. By creating a space for leisure, USS can encourage visitors to stay longer in the park, increasing their overall spending on food, drinks, and potentially event tickets or VIP access to exclusive viewing areas for major events.

4. Adventure and Extreme Sports Experiences: Introduce extreme sports or adventure activities, such as virtual reality (VR) experiences, rock climbing, or even a high-flying experience like bungee jumping

Adventure and extreme sports experiences are often popular among men who seek thrilling, physically demanding activities. Charging for these activities separately or offering package deals can drive additional revenue. Such experiences can also increase the time visitors spend in the park, resulting in more spending on food, drinks, and merchandise. These types of attractions also encourage repeat visits from thrill-seekers.

--------------------------------------------------------------------------------

**Tourists**

1. Launch International Marketing Campaigns: Partner with international travel agencies, airlines, and influencers to launch targeted marketing campaigns in key tourist markets such as China, India and Southeast Asia

International tourists typically spend more on experiences, food, and souvenirs when visiting a theme park. By attracting more tourists from overseas, USS can tap into new revenue streams from foreign visitors who may also contribute to increased hotel bookings, travel packages, and extended stays. This kind of exposure boosts ticket sales, as well as demand for premium experiences like VIP tours and fast passes, which increase overall spending per guest.

2. Create Seasonal or Themed Events to Attract Tourists During Off-Peak Periods

Host special seasonal or limited-time themed events such as "Summer Fest" or "Halloween Horror Nights" to entice tourists during off-peak months. Promoting these events through global tourism channels can attract visitors specifically interested in these unique experiences. Special events generate excitement and urgency, encouraging tourists to visit USS during times when they might otherwise not have considered it. These events can drive up ticket prices for exclusive access, increase the sale of themed merchandise, and boost spending on food and beverage items. The demand for limited-time events can also increase park attendance during historically slower seasons, reducing revenue loss from lower off-peak visitation.

3. Offer Multi-Day Passes with Exclusive Benefits for Tourists: Introduce multi-day passes specifically targeted at tourists, which allow for unlimited access to USS and partner attractions over a certain number of days

Multi-day passes encourage tourists to spend more time at USS, potentially increasing per-visitor revenue. Tourists who purchase multi-day passes are more likely to spend on food, merchandise, and add-on services like express passes or special events. By offering exclusive benefits, USS also incentivizes higher-priced purchases and repeat visits during the tourist's stay in Singapore.

4. Develop Unique Tourist-Centric Experiences and Packages: Create unique experiences tailored to tourists - behind-the-scenes tours, private character meet-and-greets or exclusive access to new attractions

Unique, premium experiences can command higher prices and attract tourists willing to pay extra for exclusive access. Offering tailored experiences encourages tourists to spend more than they would on standard tickets, boosting overall revenue per guest. These high-value experiences can also be marketed as limited-time offers, increasing demand and encouraging tourists to visit USS sooner rather than later. Additionally, the luxury appeal of these experiences may attract high-net-worth tourists, further increasing revenue from premium offerings.

--------------------------------------------------------------------------------

**Families with Young Children**

1. Family Passes: Offer bundles that include tickets for two adults and two children at a discounted rate.

Family bundles make the experience more affordable for families, which can lead to a higher volume of ticket sales. Families are more likely to purchase bundles, as they feel they are getting better value for money. The discounted rate encourages families to buy tickets for both parents and children at once, and they might also purchase additional services like food, merchandise, or express passes, boosting overall revenue. Offering bundled pricing creates a sense of cost savings, increasing the likelihood of families committing to a visit.

2. Free Entry for Toddlers: Provide free admission for children under 3 years old, making it more affordable for families.

While offering free admission to toddlers may seem like a loss of revenue for the very young group, it encourages families to visit USS in the first place. With younger children not being charged for tickets, families with toddlers are more likely to attend. These families will still contribute to revenue by spending on food, merchandise, photo ops, and additional experiences that are not discounted, which helps to offset the "free" entry for the toddlers. This approach also attracts more repeat visits as parents may return when they have multiple children of different age groups.

3. Interactive Learning Stations: Set up engaging, hands-on experiences related to the movies and themes (eg movie-making workshops, or behind-the-scenes shows)
Seasonal Family Events: Host special themed events (eg Christmas or Halloween) with kid-friendly activities

Interactive and educational experiences are highly attractive to families, especially when they are tied to popular movie themes that kids love. These types of experiences can be monetized through special admission fees or bundled with ticket sales as part of a premium package. Additionally, interactive stations encourage parents and children to spend more time at the venue, which leads to increased spending on food, drinks, souvenirs, and other experiences. Children's participation in workshops also leads to a memorable experience, increasing the likelihood of word-of-mouth recommendations and repeat visits, which drives future revenue.

4. Character Meet-and-Greets: Feature more kid-friendly characters apart from the usual ones that are currently available in USS for family photos and interactions

Character meet-and-greets are a major draw for families with young children. Offering popular, kid-friendly characters allows USS to charge a premium for exclusive photo opportunities or VIP meet-and-greet experiences. Families are willing to pay for these experiences to create lasting memories and unique interactions for their children. Additionally, character-themed merchandise can be sold at meet-and-greet locations, further increasing revenue from each family. The emotional connection created by meeting beloved characters encourages families to visit more often, especially if they know new characters or themed experiences are coming up.

--------------------------------------------------------------------------------

**Working Adults**

1. After-Work or Late-Night Events: Host special after-work or late-night events that cater to working adults, such as "Happy Hour" events, themed parties, or exclusive access to certain attractions or shows during the evening

These events can drive attendance during typically off-peak hours, filling the park when it may otherwise be less crowded. By offering special events, USS can attract working adults who may not typically have the time to visit during the day, increasing overall ticket sales. The addition of exclusive experiences like VIP access, premium shows, or food and beverage deals can encourage working adults to spend more, boosting revenue from premium packages, food, drinks, and merchandise. The events can also include paid add-ons like drink tickets or special photo opportunities, further driving spending.

2. Corporate Partnership Packages: Partner with businesses and corporations to offer exclusive corporate discounts or team-building packages for employees

Corporate partnerships can lead to bulk ticket sales, generating significant revenue from organizations buying tickets for groups of employees. Team-building events or group outings create opportunities for USS to offer additional upsells, like lunch or dinner packages, private tours, or special events tailored to corporate groups. The exposure to corporate clients may encourage them to visit USS for personal trips, bringing in new customers and increasing repeat visits. Offering exclusive perks or experiences for employees can elevate the value proposition, driving higher ticket sales and additional purchases.

3. Weekend Relaxation and Wellness Packages: Develop relaxation and wellness-focused weekend packages, including stress-relief activities, spa experiences, or health-themed events

Wellness and relaxation activities can be a unique selling point for working adults looking for an alternative to traditional amusement park experiences. These experiences could be monetized through premium pricing for spa treatments, wellness seminars, or stress-relief activities like yoga sessions or nature walks. The packages can encourage longer stays, resulting in higher spending on food, merchandise, and optional add-ons. Offering wellness experiences could attract affluent working adults who may be willing to pay for higher-end experiences and services, leading to increased overall revenue.Marketing these packages as exclusive or limited-time offerings can drive demand and create a sense of urgency, boosting sales.

--------------------------------------------------------------------------------

**All these strategies listed above will help to improve visitor experience, whether be in terms of financially, enjoyability, emotionally or flexibility. Satisfaction rates will increase if the following strategies are to be implemented. These strategies might help to achieve USS's goal of improving satisfaction rates to higher levels and at the same time, increase its revenue due to higher demand.**
"""